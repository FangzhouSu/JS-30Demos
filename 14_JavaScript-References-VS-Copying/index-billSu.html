<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JS æ•°ç»„ã€å¯¹è±¡ä¸­çš„å¼•ç”¨å’Œå¤åˆ¶ | by billSu</title>
  <link rel="shortcut icon" href="../favicon.ico">
</head>
<body>
    <style>
        .billSu-header {
          /* æ”¹äº†ä¸€ä¸‹å¤´éƒ¨çš„æ ·å¼ ä¿è¯å®ƒä¸€ç›´è´´åœ¨æœ€ä¸Šé¢ */
            /* position: absolute; */
            top: 0;
            left: 0;
            width: 100%;
            background-color: rgb(21, 21, 21);
            text-align: center;
            padding: 10px;
            color: #dde666;
            font-size: 20px;
            font-weight: 100;
            z-index: 999;
        }
        .billSu-header span{
            margin: 0 5px;
        }
        .billSu-header a{
            text-decoration: none;
            color: unset;
        }
        a:hover{
            background-color:rgb(116, 116, 116);
        }
    </style>
    <div class="billSu-header">
        <span><a href="https://github.com/wesbos/JavaScript30" target="_blank">JavaScript30 çµæ„Ÿæ¥æº</a></span>
        <span>|</span>
        <span><a href="https://github.com/FangzhouSu/JS-30Demos" target="_blank">æœ¬é¡¹ç›®ä»“åº“-billSU</a></span>
        <span>|</span>
        <span><a href="https://blog.csdn.net/qq_45704942?spm=1010.2135.3001.5421&type=blog" target="_blank">äº†è§£æˆ‘</a></span>
    </div>

    <h1>è¯·æ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹ç»†åˆ™ğŸ§</h1>
    <p>é€šè¿‡è¿™éƒ¨åˆ†æˆ‘ä»¬å¯ä»¥æ„Ÿå—JavaScriptä¸­å¯¹ä¸åŒæ•°æ®ç±»å‹çš„â€œå¼•ç”¨ Referenceâ€ å’Œ â€œå¤åˆ¶ Copyâ€çš„åŒºåˆ«</p>

    <script>
        // start with strings, numbers and booleans
        // 01 å‘ç”Ÿäº†å¸¸è§„å€¼ä¼ é€’ è€Œä¸æ˜¯åœ°å€å€¼
        let age = 100;
        let age2 = age;
        console.log("01 å‘ç”Ÿäº†å¸¸è§„å€¼ä¼ é€’ è€Œä¸æ˜¯åœ°å€å€¼");
        console.log(age, age2);// 100 100
        age = 200;
        console.log(age, age2);// 200 100


        // Let's say we have an array
        const players = ['Wes', 'Sarah', 'Ryan', 'Poppy'];

        // and we want to make a copy of it.
        const team = players;
        console.log("02 ç ”ç©¶æ•°ç»„çš„ä¼ é€’ï¼ˆå¼•ç”¨å€¼ä¼ é€’ å› ä¸ºæ•°ç»„ä¹Ÿæ˜¯ä¸ªå¯¹è±¡~ï¼‰");
        console.log(players, team);// ['Wes', 'Sarah', 'Ryan', 'Poppy']; ['Wes', 'Sarah', 'Ryan', 'Poppy'];

        // You might think we can just do something like this:
        team[0] = 'bill666';
        console.log("å¼•ç”¨å˜é‡teamå’ŒplayersæŒ‡å‘çš„åŒä¸€ä¸ªåœ°å€ï¼æ‰€ä»¥æ”¹å˜æ˜¯åŒæ­¥çš„~");
        console.log(players, team);//['bill666', 'Sarah', 'Ryan', 'Poppy']; ['bill666', 'Sarah', 'Ryan', 'Poppy']; 

        // however what happens when we update that array?ä½†æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªæ•°ç»„çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

        // now here is the problem!è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨

        // oh no - we have edited the original array too!NOï¼ åŸæ•°ç»„ä¹Ÿè¢«ä¿®æ”¹è¿‡äº†

        // Why? It's because that is an array reference, not an array copy. They both point to the same array!
        // ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º team åªæ˜¯è¿™ä¸ªæ•°ç»„çš„å¼•ç”¨ï¼Œå¹¶ä¸æ˜¯å®ƒçš„å¤åˆ¶ã€‚
        // team å’Œ players æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªæ•°ç»„ã€‚

        console.log("03 å¤åˆ¶æ•°ç»„ è€Œä¸æ˜¯å¼•ç”¨æ•°ç»„");
        console.log("ä¹Ÿå°±æ˜¯è®©å¼•ç”¨å˜é‡team ä¸ playersæŒ‡å‘çš„ä¸æ˜¯åŒä¸€ä¸ªæ•°ç»„ï¼ˆç›´è§‚è¡¨ç°ä¸ºäºŒè€…çš„å¼•ç”¨åœ°å€ä¸åŒï¼‰");
        // So, how do we fix this? We take a copy instead!æ‰€ä»¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿä¸‹é¢æ¥è¿›è¡Œå¤åˆ¶ å–ä»£"å¼•ç”¨1"ã€‚
        console.log("   è§£å†³æ–¹æ³•01 åˆ©ç”¨Array.prototype.slice()å¤åˆ¶ è€Œä¸æ˜¯å¼•ç”¨ï¼ˆåœ°å€å€¼ä¼ é€’ï¼‰");
        const team2 = players.slice();

        // one way

        // or create a new array and concat the old one in
        console.log("   è§£å†³æ–¹æ³•02 åˆ›å»ºæ–°æ•°ç»„å¹¶åˆ©ç”¨Array.prototype.concat()å¤åˆ¶");
        const team3 = [].concat(players);

        // or use the new ES6 Spread
        console.log("   è§£å†³æ–¹æ³•03 åˆ©ç”¨æ‰©å±•è¿ç®—ç¬¦å¤åˆ¶");
        const team4 = [...players];

        // now when we update it, the original one isn't changed
        console.log("   è§£å†³æ–¹æ³•04 ES6ä¸­çš„fromæ–¹æ³• å…¶å®ä¹Ÿæ˜¯å¤åˆ¶~");
        const team5 = Array.from(players);

        // The same thing goes for objects, let's say we have a person object
        // å¯¹ Object ç±»å‹çš„æ•°æ®æ¥è¯´ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ª person ä¾‹å­æ¥è¯´æ˜

        // with Objects
        const person = {
            name: 'Wes Bos',
            age: 80
        };

        // and think we make a copy:
        // const captain = person;
        // captain.number = 99;// è¿™æ ·ä¼šå¯¼è‡´personå¯¹è±¡çš„numberå±æ€§ä¹Ÿè¢«æ·»åŠ ï¼ˆæœ¬æ¥æ˜¯æ²¡æœ‰çš„ï¼‰

        // how do we take a copy instead?
        console.log("04 å¤åˆ¶å¯¹è±¡ è€Œä¸æ˜¯å¼•ç”¨å¯¹è±¡");
        console.log("   è§£å†³æ–¹æ³•1 Object.assign() æµ…æ‹·è´çš„æ–¹æ³•");
        const cap = Object.assign({}, person, {number: 99, age:12});//â€” è¿™é‡Œè¿›è¡Œäº†ä¸€å±‚åµŒå¥—çš„æµ…æ‹·è´
        console.log(person,cap);// äºŒè€…çš„åœ°å€æ˜¯ä¸åŒçš„ï¼ç»™capèµ‹å€¼ä¸ä¼šæ”¹å˜person

        // We will hopefully soon see the object ...spread
        // const cap3 = {...person};

        // Things to note - this is only 1 level deep - both for Arrays and Objects. lodash has a cloneDeep method, but you should think twice before using it.
        // éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™é‡Œçš„ä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬ç”¨çš„æ•°ç»„å’Œå¯¹è±¡éƒ½åªæ˜¯ä¸€å±‚åµŒå¥—ï¼Œ
        // Lodash æœ‰ä¸€ä¸ªæ·±åº¦å¤åˆ¶çš„æ–¹æ³•ï¼Œä½†ä½ ä½¿ç”¨ä¹‹å‰éœ€è¦å¤šè€ƒè™‘ä¸€ä¸‹ã€‚
        const wes = {
            name: 'Wes',
            age: 100,
            social: {
                twitter: '@wesbos',
                facebook: 'wesbos.developer'
            }
        };

        console.log("   è§£å†³æ–¹æ³•2 JSONè½¬æ¢ è¿›è¡Œäº†æ·±æ‹·è´");
        const dev = JSON.parse(JSON.stringify(wes));
        dev.social.name = 'æˆ‘ä¸ä¼šå½±å“åˆ°åŸå¯¹è±¡å•¦å•¦å•¦'// è¿›è¡Œäº†æ·±æ‹·è´ ä¸ä¼šä½¿weså¯¹è±¡çš„socialå­å¯¹è±¡åŒæ—¶è¢«æ›´æ”¹ 

        const dev2 = Object.assign({}, wes);
        dev2.social.name = 'wes'// è¿™ç§æ–¹æ³•çš„æµ…æ‹·è´ ä¼šä½¿weså¯¹è±¡çš„socialå­å¯¹è±¡åŒæ—¶è¢«æ›´æ”¹
        console.log(wes, dev, dev2);// å¯ä»¥çœ‹çœ‹æ‰“å°å‡ºæ¥çš„æ•ˆæœ è›®æœ‰æ„æ€çš„~


    </script>

</body>
</html>
